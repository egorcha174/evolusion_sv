# Project Log

| Date (UTC) | Task ID | Step ID | Title | Goal | Files Changed | Verification | Status | Next Step | Notes |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 2023-10-27 | T-INIT-01 | E0-01 | Init Docs | Establish project rules and specs | docs/TECH_SPEC.md, docs/PROJECT_LOG.md | Visual check | **Completed** | E0-03 (Scripts) | Foundation set. No code yet. |
| 2024-05-22 | T-SCAFFOLD-01 | E0-03 | Scaffolding | Remove React, init SvelteKit | package.json, svelte.config.js, vite.config.ts, src/*, index.tsx | Build pass | **Completed** | E0-04 (Smoke E2E) | Replaced index.tsx with SvelteKit structure |
| 2024-05-22 | T-CLEANUP-01 | E0-03a | Cleanup | Delete legacy index.tsx | index.tsx | Visual | **Completed** | E0-04 (Smoke E2E) | File content cleared (pending physical deletion) |
| 2024-05-22 | T-CLEANUP-02 | E0-03b | Remove File | Remove index.tsx | index.tsx | File check | **Completed** | E0-04 (Smoke E2E) | Removed legacy file |
| 2024-05-22 | E0-04 | e0-04-smoke | Smoke E2E setup | Setup Playwright and smoke test | package.json, playwright.config.ts, tests/test.ts, docs/PROJECT_LOG.md | npm run check → pass, npm run build → pass, npm run test → pass | **Completed** | E1-01 (Settings Page) | Basic e2e setup |
| 2024-05-22 | E1-01 | e1-01-settings | Settings page | Create UI for HA connection config | src/routes/settings/+page.svelte, src/lib/types.ts, src/domains/app/store.ts, src/routes/+layout.svelte, docs/PROJECT_LOG.md | Check, Lint, Build, Smoke Pass | **Completed** | E1-02 (HA WebSocket client) | Implemented settings with localStorage (no encryption yet). Fixed store to use writable. |
| 2024-05-22 | E1-02 | e1-02-ha-websocket | HA WebSocket client | Create core HAClient with auth/commands | src/domains/ha/api.ts, src/domains/ha/contracts/messages.ts, src/lib/types.ts, tests/ha-client.test.ts, docs/PROJECT_LOG.md | Check, Lint, Build, Tests (4) Pass | **Completed** | E1-03 (HA Store) | Client handles auth flow, commands, and subscriptions using MockWebSocket for testing. |
| 2024-05-22 | E1-03 | e1-03-ha-store | HA Store | Manage HA connection and entities state | src/domains/ha/store.ts, src/lib/types.ts, src/routes/+layout.svelte, tests/ha-store.test.ts, docs/PROJECT_LOG.md | Check, Lint, Build, Tests (6) Pass | **Completed** | E1-04 (All Entities Page) | Store implements connection lifecycle, initial fetch, and event updates. Integration via layout effect. |
| 2024-05-22 | E1-03a | e1-03-fix-types | Fix Store Types | Fix TypeScript error in derived store | src/domains/ha/store.ts, docs/PROJECT_LOG.md | Check pass | **Completed** | E1-04 (All Entities Page) | Explicitly typed derived stores to satisfy strict checks. |
| 2024-05-22 | E1-04 | e1-04-entities-page | All Entities Page | Create list view with filters | src/routes/entities/+page.svelte, src/domains/ui/EntityList.svelte, src/domains/ui/EntityRow.svelte, src/lib/utils.ts, src/routes/+layout.svelte, docs/PROJECT_LOG.md | Check, Lint, Build, Smoke Pass | **Completed** | E1-05 (Call Services) | UI lists entities, filters by domain/search. Mock toggle logs to console. |
| 2024-05-22 | E1-05 | e1-05-call-service | Call Services | Implement callService and toggleEntity | src/domains/ha/api.ts, src/domains/ha/store.ts, docs/PROJECT_LOG.md | Check, Lint, Build Pass | **Completed** | E1-05a (UI Integration) | Added core service call logic. Next: connect UI buttons to these functions. |
| 2024-05-22 | E1-05a | e1-05-ui-integration | UI Integration | Connect EntityRow to real toggleEntity | src/domains/ui/EntityRow.svelte, docs/PROJECT_LOG.md | Check, Lint, Build, Manual verification Pass | **Completed** | E1-06 (Secure Storage) | Buttons now trigger actual HA service calls. Error state added to UI. |
| 2024-05-22 | E1-06 | e1-06-secure-storage | Secure Storage | Encrypt token in localStorage using AES-GCM | src/domains/ha/crypto.ts, src/domains/app/store.ts, src/routes/settings/+page.svelte, docs/PROJECT_LOG.md | Check, Lint, Build, Manual verify (Settings load) | **Completed** | E1-07 (Mock WS Contract) | Config is now encrypted on save and decrypted on load. |
| 2024-05-22 | E3-01 | e3-01-dashboard-grid | Dashboard Grid | Create main dashboard with DeviceCards | src/domains/ui/DeviceCard.svelte, src/domains/ui/DashboardGrid.svelte, src/routes/+page.svelte, docs/PROJECT_LOG.md | Check, Lint, Build Pass | **Completed** | E3-02 (DnD & Persist) | Main dashboard now shows a grid of cards for common domains (light, switch, cover, etc). |
| 2024-05-22 | E3-02 | e3-02-dnd-persist | DnD & Persist | Enable drag-and-drop and save layout securely | src/domains/ui/DashboardGrid.svelte, src/domains/app/store.ts, src/lib/types.ts, package.json, src/routes/+layout.svelte, docs/PROJECT_LOG.md | Check, Lint, Build, Manual Verify Pass | **Completed** | E4-01 (UI Polish) | Users can rearrange cards, layout saves encrypted to localStorage. |
| 2024-05-22 | E4-01 | e4-01-ui-polish | UI Polish | Sidebar, Header, Icons | package.json, src/lib/icons.ts, src/domains/ui/Sidebar.svelte, src/domains/ui/Header.svelte, src/routes/+layout.svelte, src/domains/ui/DeviceCard.svelte, src/app.css, docs/PROJECT_LOG.md | Visual check | **Completed** | E4-02 (InfoPanel) | Added dark sidebar, polished header, MDI icons. |
| 2024-05-22 | E4-02 | e4-02-info-panel | InfoPanel | InfoPanel with Glassmorphism | src/domains/ui/InfoPanel.svelte, src/domains/ui/store.ts, src/routes/+layout.svelte, docs/PROJECT_LOG.md | Check, Lint, Build Pass | **Completed** | E4-03 (Navigation) | Implemented resizable panel. |
| 2024-05-22 | E4-03 | e4-03-header-nav | Dashboard Header | Header with tabs and menu | src/domains/ui/DashboardHeader.svelte, src/domains/app/tabsStore.ts, src/routes/+layout.svelte, docs/PROJECT_LOG.md | Check, Lint, Build Pass | **Completed** | E4-04 (Polish) | Tabs switch active state, Kebab menu works. |
| 2024-05-22 | T-THEME-02 | e4-04-advanced-theme | Advanced Theme System | Strict Palette, Multiple Themes, Store Logic | src/lib/types.ts, src/domains/ui/theme/*, src/app.css, src/routes/+layout.svelte, src/domains/ui/* | Build, Visual Check (Themes) | **Completed** | Next | Full strict palette implementation with Default, Apple, and Material themes. |
| 2024-05-22 | T-UI-01 | e4-05-tabs-logic | Tabs Logic | Implement filtering by active tab | src/domains/ui/DashboardGrid.svelte, src/domains/ui/DashboardHeader.svelte | Manual Verify | **Completed** | Next | Entities filter by name matching tab ID. |
| 2024-05-22 | T-FIX-01 | e-fix-nav | Fix Tab Navigation | Navigate to home when clicking tabs from other pages | src/domains/ui/DashboardHeader.svelte | Manual Verify | **Completed** | Next | ... |
| 2024-05-22 | T-UI-02 | e4-06-ui-cleanup | UI Cleanup | Remove logo text, move status to sidebar | src/domains/ui/DashboardHeader.svelte, src/domains/ui/Sidebar.svelte | Manual Verify | **Completed** | Next | ... |
| 2024-05-22 | T-FIX-02 | e-fix-sidebar | Fix Sidebar Visibility | Add Sidebar to layout, fix positioning and theme contrast | src/routes/+layout.svelte, src/domains/ui/Sidebar.svelte, src/domains/ui/theme/defaults.ts | Visual Check | **Completed** | Next | ... |