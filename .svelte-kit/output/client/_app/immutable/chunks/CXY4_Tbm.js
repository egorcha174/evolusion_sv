import{I as k,n as C,J as Q,K as D,M as W,O as Z,a as V,b as $,Q as G,R as P,T as Y,U as O,V as x,W as j,X as ee,Y as L,o as re,Z as z,_ as ne,$ as y,a0 as fe,a1 as U,a2 as ae,a3 as le,a4 as ie,a5 as ue,a6 as w,a7 as q,a8 as B,a9 as H,aa as se,ab as oe,ac as te}from"./CHWeQpjd.js";function ve(e,l,a){for(var c=[],g=l.length,u,i=l.length,n=0;n<g;n++){let s=l[n];B(s,()=>{if(u){if(u.pending.delete(s),u.done.add(s),u.pending.size===0){var d=e.outrogroups;F(y(u.done)),d.delete(u),d.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var o=c.length===0&&a!==null;if(o){var f=a,t=f.parentNode;oe(t),t.append(f),e.items.clear()}F(l,!o)}else u={pending:new Set(l),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(u)}function F(e,l=!0){for(var a=0;a<e.length;a++)te(e[a],l)}var X;function ge(e,l,a,c,g,u=null){var i=e,n=new Map;{var o=e;i=C?k(Q(o)):o.appendChild(D())}C&&W();var f=null,t=$(()=>{var p=a();return fe(p)?p:p==null?[]:y(p)}),s,d=!0;function N(){_.fallback=f,ce(_,s,i,l,c),f!==null&&(s.length===0?f.f&w?(f.f^=w,S(f,null,i)):q(f):B(f,()=>{f=null}))}var r=Z(()=>{s=V(t);var p=s.length;let E=!1;if(C){var h=G(i)===P;h!==(p===0)&&(i=Y(),k(i),O(!1),E=!0)}for(var M=new Set,T=re,I=ne(),m=0;m<p;m+=1){C&&x.nodeType===j&&x.data===ee&&(i=x,E=!0,O(!1));var R=s[m],A=c(R,m),v=d?null:n.get(A);v?(v.v&&L(v.v,R),v.i&&L(v.i,m),I&&T.skipped_effects.delete(v.e)):(v=de(n,d?i:X??(X=D()),R,A,m,g,l,a),d||(v.e.f|=w),n.set(A,v)),M.add(A)}if(p===0&&u&&!f&&(d?f=z(()=>u(i)):(f=z(()=>u(X??(X=D()))),f.f|=w)),C&&p>0&&k(Y()),!d)if(I){for(const[J,K]of n)M.has(J)||T.skipped_effects.add(K.e);T.oncommit(N),T.ondiscard(()=>{})}else N();E&&O(!0),V(t)}),_={effect:r,items:n,outrogroups:null,fallback:f};d=!1,C&&(i=x)}function ce(e,l,a,c,g){var A;var u=l.length,i=e.items,n=e.effect.first,o,f=null,t=[],s=[],d,N,r,_;for(_=0;_<u;_+=1){if(d=l[_],N=g(d,_),r=i.get(N).e,e.outrogroups!==null)for(const v of e.outrogroups)v.pending.delete(r),v.done.delete(r);if(r.f&w)if(r.f^=w,r===n)S(r,null,a);else{var p=f?f.next:n;r===e.effect.last&&(e.effect.last=r.prev),r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),b(e,f,r),b(e,r,p),S(r,p,a),f=r,t=[],s=[],n=f.next;continue}if(r.f&H&&q(r),r!==n){if(o!==void 0&&o.has(r)){if(t.length<s.length){var E=s[0],h;f=E.prev;var M=t[0],T=t[t.length-1];for(h=0;h<t.length;h+=1)S(t[h],E,a);for(h=0;h<s.length;h+=1)o.delete(s[h]);b(e,M.prev,T.next),b(e,f,M),b(e,T,E),n=E,f=T,_-=1,t=[],s=[]}else o.delete(r),S(r,n,a),b(e,r.prev,r.next),b(e,r,f===null?e.effect.first:f.next),b(e,f,r),f=r;continue}for(t=[],s=[];n!==null&&n!==r;)(o??(o=new Set)).add(n),s.push(n),n=n.next;if(n===null)continue}r.f&w||t.push(r),f=r,n=r.next}if(e.outrogroups!==null){for(const v of e.outrogroups)v.pending.size===0&&(F(y(v.done)),(A=e.outrogroups)==null||A.delete(v));e.outrogroups.size===0&&(e.outrogroups=null)}if(n!==null||o!==void 0){var I=[];if(o!==void 0)for(r of o)r.f&H||I.push(r);for(;n!==null;)!(n.f&H)&&n!==e.fallback&&I.push(n),n=n.next;var m=I.length;if(m>0){var R=u===0?a:null;ve(e,I,R)}}}function de(e,l,a,c,g,u,i,n){var o=i&ie?i&ue?U(a):ae(a,!1,!1):null,f=i&le?U(g):null;return{v:o,i:f,e:z(()=>(u(l,o??a,f??g,n),()=>{e.delete(c)}))}}function S(e,l,a){if(e.nodes)for(var c=e.nodes.start,g=e.nodes.end,u=l&&!(l.f&w)?l.nodes.start:a;c!==null;){var i=se(c);if(u.before(c),c===g)return;c=i}}function b(e,l,a){l===null?e.effect.first=a:l.next=a,a===null?e.effect.last=l:a.prev=l}function he(e){return e.split(".")[0]}function _e(e){return["light","switch","cover","lock","input_boolean","automation","script"].includes(e)}export{ge as a,he as e,_e as i};
