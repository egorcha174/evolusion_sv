import{a as i,f as p,c as F,t as U}from"./CYiN1Ptg.js";import{K as zt,u as St,m as Dt,a as e,B as u,C as f,A as g,n as It,ak as X,s as K,al as z,z as S,E as D}from"./DrE23S9z.js";import{d as Mt,e as jt,s as w}from"./Dx6vUp0w.js";import{i as h,s as Ot,a as Rt}from"./d16_jLoQ.js";import{s as N,a as Y,b as vt,e as Vt,d as T,f as Bt,$ as Ft}from"./DoxDpSa6.js";import{a as Kt,e as Nt}from"./-3n6O5sP.js";function Pt(c,t,m){zt(()=>{var I=St(()=>t(c,m==null?void 0:m())||{});if(I!=null&&I.destroy)return()=>I.destroy()})}function Z(c){const t=new IntersectionObserver(m=>{m[0].isIntersecting&&(c.dispatchEvent(new CustomEvent("enter")),t.disconnect())},{rootMargin:"100px",threshold:0});return t.observe(c),{destroy(){t.disconnect()}}}function Wt(c){const t=[];switch(c.backgroundType==="transparent"?(t.push("--card-background: transparent"),t.push("--card-background-on: transparent")):(t.push(`--card-background: ${c.backgroundColor}`),t.push(`--card-background-on: ${c.backgroundColor}`)),t.push(`--card-opacity: ${c.opacity}`),t.push(`--card-padding: ${c.padding}px`),c.shadow){case"sm":t.push("--shadow-card: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)");break;case"md":t.push("--shadow-card: 0 4px 6px rgba(0,0,0,0.1)");break;case"lg":t.push("--shadow-card: 0 10px 15px rgba(0,0,0,0.1)");break;case"none":t.push("--shadow-card: none");break}return t.join("; ")}var qt=p('<div class="skeleton svelte-vmg48c"></div>'),Gt=p("<iconify-icon></iconify-icon>",2),Ht=p("<div><!></div>"),Jt=p('<span class="device-unit svelte-vmg48c"> </span>'),Lt=p('<div class="attribute svelte-vmg48c"> </div>'),Qt=p('<div class="card-header svelte-vmg48c"><div class="icon svelte-vmg48c"><iconify-icon></iconify-icon></div> <div class="device-name svelte-vmg48c"> </div></div> <div class="card-body svelte-vmg48c"><div class="state-container svelte-vmg48c"><span class="device-value svelte-vmg48c"> </span> <!></div> <!></div>',3),Ut=p('<div class="error svelte-vmg48c"> </div>'),Xt=p('<button class="add-to-dashboard-btn svelte-vmg48c"><iconify-icon></iconify-icon> <span class="btn-text svelte-vmg48c"> </span></button>',2),Yt=p("<!> <!> <!>",1),Zt=p('<div role="button" tabindex="0"><!></div>');function re(c,t){Dt(t,!0);const m=()=>Rt(Ft,"$t",I),[I,dt]=Ot();let $=X(!1),P=X(null),tt=X(!1);async function et(){try{K($,!0),K(P,null),await Kt(t.entity.entity_id)}catch(a){K(P,a.message||"Failed to toggle",!0)}finally{K($,!1)}}function lt(){K(tt,!0)}let q=z(()=>Nt(t.entity.entity_id)),G=z(()=>t.entity.attributes.friendly_name||t.entity.entity_id),ut=z(()=>t.entity.state==="on"||t.entity.state==="open"||t.entity.state==="unlocked"),at=z(()=>["light","switch","cover","lock","input_boolean","script"].includes(e(q))),nt=z(()=>Bt(e(q))),it=z(()=>t.entity.state==="on"?m()("common.on"):t.entity.state==="off"?m()("common.off"):t.entity.state==="unavailable"?m()("entities.status.unavailable"):t.entity.state==="unknown"?m()("entities.status.unknown"):t.entity.state),ft=z(()=>t.template?Wt(t.template.style):""),rt=z(()=>t.template&&t.template.elements&&t.template.elements.length>0);function mt(a){const n=a.style,C=[`left: ${a.x}%`,`top: ${a.y}%`,`color: ${n.color||"inherit"}`,`font-size: ${n.fontSize?n.fontSize+"px":"inherit"}`,`font-weight: ${n.fontWeight||"inherit"}`,`text-align: ${n.textAlign||"left"}`,`opacity: ${n.opacity??1}`,`z-index: ${n.zIndex??1}`];return a.w&&C.push(`width: ${a.w}%`),a.h&&C.push(`height: ${a.h}%`),n.backgroundColor&&C.push(`background-color: ${n.backgroundColor}`),n.borderRadius&&C.push(`border-radius: ${n.borderRadius}px`),C.join(";")}var b=Zt();let st;b.__click=function(...a){var n;(n=e(at)?et:void 0)==null||n.apply(this,a)},b.__keydown=a=>e(at)&&(a.key==="Enter"||a.key===" ")&&et();var _t=u(b);{var gt=a=>{var n=qt();i(a,n)},ht=a=>{var n=Yt(),C=S(n);{var bt=o=>{var r=F(),v=S(r);Vt(v,17,()=>t.template.elements,y=>y.id,(y,s)=>{var d=Ht(),E=u(d);{var W=_=>{var x=Gt();g(()=>T(x,"icon",e(nt))),T(x,"width","100%"),T(x,"height","100%"),N(x,1,"svelte-vmg48c"),i(_,x)},O=_=>{var x=F(),H=S(x);{var J=A=>{var l=U();g(()=>w(l,e(G))),i(A,l)},L=A=>{var l=F(),k=S(l);{var R=M=>{var V=U();g(()=>w(V,e(it))),i(M,V)},Q=M=>{var V=F(),wt=S(V);{var Tt=j=>{var B=U();g(()=>w(B,e(s).label||"Text")),i(j,B)},Ct=j=>{var B=F(),Et=S(B);{var At=ct=>{};h(Et,ct=>{e(s).type==="shape"&&ct(At)},!0)}i(j,B)};h(wt,j=>{e(s).type==="label"?j(Tt):j(Ct,!1)},!0)}i(M,V)};h(k,M=>{e(s).type==="state"?M(R):M(Q,!1)},!0)}i(A,l)};h(H,A=>{e(s).type==="name"?A(J):A(L,!1)},!0)}i(_,x)};h(E,_=>{e(s).type==="icon"?_(W):_(O,!1)})}f(d),g(_=>{N(d,1,`card-element type-${e(s).type??""}`,"svelte-vmg48c"),vt(d,_)},[()=>mt(e(s))]),i(y,d)}),i(o,r)},yt=o=>{var r=Qt(),v=S(r),y=u(v),s=u(y);g(()=>T(s,"icon",e(nt))),T(s,"width","24"),T(s,"height","24"),N(s,1,"svelte-vmg48c"),f(y);var d=D(y,2),E=u(d,!0);f(d),f(v);var W=D(v,2),O=u(W),_=u(O),x=u(_,!0);f(_);var H=D(_,2);{var J=l=>{var k=Jt(),R=u(k,!0);f(k),g(()=>w(R,t.entity.attributes.unit_of_measurement)),i(l,k)};h(H,l=>{t.entity.attributes.unit_of_measurement&&l(J)})}f(O);var L=D(O,2);{var A=l=>{var k=Lt(),R=u(k);f(k),g(Q=>w(R,`${Q??""}%`),[()=>Math.round(t.entity.attributes.brightness/255*100)]),i(l,k)};h(L,l=>{t.entity.attributes.brightness!==void 0&&l(A)})}f(W),g(()=>{Y(d,"title",e(G)),w(E,e(G)),w(x,e(it))}),i(o,r)};h(C,o=>{e(rt)&&t.template?o(bt):o(yt,!1)})}var ot=D(C,2);{var xt=o=>{var r=Ut(),v=u(r,!0);f(r),g(()=>w(v,e(P))),i(o,r)};h(ot,o=>{e(P)&&o(xt)})}var pt=D(ot,2);{var kt=o=>{var r=Xt();r.__click=d=>{var E;d.stopPropagation(),(E=t.onAddToTab)==null||E.call(t)};var v=u(r);T(v,"icon","mdi:view-dashboard-plus-outline"),T(v,"width","16"),T(v,"height","16"),N(v,1,"svelte-vmg48c");var y=D(v,2),s=u(y,!0);f(y),f(r),g((d,E)=>{Y(r,"title",d),w(s,E)},[()=>m()("entities.addToTab.button",{default:"Add to Dashboard"}),()=>m()("common.add",{default:"Add"})]),i(o,r)};h(pt,o=>{t.onAddToTab&&o(kt)})}i(a,n)};h(_t,a=>{e(tt)?a(ht,!1):a(gt)})}f(b),Pt(b,a=>Z==null?void 0:Z(a)),g(()=>{st=N(b,1,"device-card svelte-vmg48c",null,st,{active:e(ut),"visual-mode":e(rt)}),Y(b,"data-domain",e(q)),vt(b,e(ft))}),jt("enter",b,lt),i(c,b),It(),dt()}Mt(["click","keydown"]);export{re as D};
