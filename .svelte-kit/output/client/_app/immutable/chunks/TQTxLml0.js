import{af as m,ag as _}from"./CM9YBULs.js";import{h as p,l as A}from"./3QiWljis.js";const b=[{id:"home",title:"Dashboard",icon:"mdi:view-dashboard"},{id:"living_room",title:"Living Room",icon:"mdi:sofa"},{id:"bedroom",title:"Bedroom",icon:"mdi:bed"}];function D(){const{subscribe:e,set:t,update:a}=m(b);return{subscribe:e,addTab:()=>a(c=>{const n=`tab_${Date.now()}`;return[...c,{id:n,title:`New Tab ${c.length+1}`}]}),removeTab:c=>a(n=>n.filter(s=>s.id!==c)),reset:()=>t(b)}}const O=D(),w=m(b[0].id),k=m(!1);function M(e){w.set(e)}function B(){k.update(e=>!e)}function u(e){return e.split(".")[0]}function R(e){return["light","switch","cover","lock","input_boolean","automation","script"].includes(e)}_(p,e=>{const t=[];for(const a of e.problemEntities){const c=e.entities.get(a);c&&t.push(c)}return t});const v=m(280),E="evolusion.sidebar.width";function U(){try{const e=localStorage.getItem(E);if(e){const t=parseInt(e,10);!isNaN(t)&&t>=200&&t<=500&&v.set(t)}}catch(e){console.error("Failed to load UI state",e)}}function F(e){try{localStorage.setItem(E,e.toString()),v.set(e)}catch(t){console.error("Failed to save UI state",t)}}const L={filters:{search:"",domain:void 0,showOnlyProblem:!1},sort:{key:"name",direction:"asc"}},I=m(L);function y(e,t,a,c){let n=e;if(t.showOnlyProblem&&(n=n.filter(s=>c.has(s.entity_id))),t.domain&&(n=n.filter(s=>u(s.entity_id)===t.domain)),t.search){const s=t.search.toLowerCase();n=n.filter(i=>{var r;return i.entity_id.includes(s)||((r=i.attributes.friendly_name)==null?void 0:r.toLowerCase().includes(s))})}return n.sort((s,i)=>{let r,d;switch(a.key){case"domain":r=u(s.entity_id),d=u(i.entity_id);break;case"state":r=s.state,d=i.state;break;case"last_changed":r=s.last_changed||"",d=i.last_changed||"";break;case"name":default:r=s.attributes.friendly_name||s.entity_id,d=i.attributes.friendly_name||i.entity_id;break}return r<d?a.direction==="asc"?-1:1:r>d?a.direction==="asc"?1:-1:0}),n}const S=_([p,I],([e,t])=>y(Array.from(e.entities.values()),t.filters,t.sort,e.problemEntities)),V=_([p,I,w,A],([e,t,a,c])=>{const n=Array.from(e.entities.values()),s=new Set(["light","switch","climate","media_player","cover","lock","script","input_boolean"]);let i=n.filter(f=>{const l=u(f.entity_id);return s.has(l)});if(a!=="home"){const l=a.split("_").map(o=>o.toLowerCase());i=i.filter(o=>{const h=(o.attributes.friendly_name||"").toLowerCase(),T=o.entity_id.toLowerCase();return l.some(g=>h.includes(g)||T.includes(g))})}(t.filters.search||t.filters.domain)&&(i=y(i,t.filters,t.sort,e.problemEntities));let r=[];const d=a==="home"&&!t.filters.search&&!t.filters.domain;if(d&&c.cardOrder.length>0){const f=i.map(o=>[o.entity_id,o]),l=new Map(f);for(const o of c.cardOrder)if(l.has(o)){const h=l.get(o);r.push({...h,id:o}),l.delete(o)}for(const o of l.values())r.push({...o,id:o.entity_id})}else d||(i=y(i,{...t.filters,search:"",domain:void 0},t.sort,e.problemEntities)),r=i.map(f=>({...f,id:f.entity_id}));return r});export{V as a,w as b,v as c,F as d,u as e,k as f,M as g,B as h,R as i,U as l,S as s,O as t,I as u};
