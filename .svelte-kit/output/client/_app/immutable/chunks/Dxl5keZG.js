import{n as f,ah as g}from"./D0a70CTa.js";const d=[...` 	
\r\fÂ \v\uFEFF`];function m(e,r,n){var t=e==null?"":""+e;if(r&&(t=t?t+" "+r:r),n){for(var o in n)if(n[o])t=t?t+" "+o:o;else if(t.length)for(var a=o.length,c=0;(c=t.indexOf(o,c))>=0;){var i=c+a;(c===0||d.includes(t[c-1]))&&(i===t.length||d.includes(t[i]))?t=(c===0?"":t.substring(0,c))+t.substring(i+1):c=i}}return t===""?null:t}function K(e,r,n,t,o,a){var c=e.__className;if(f||c!==n||c===void 0){var i=m(n,t,a);(!f||i!==e.getAttribute("class"))&&(i==null?e.removeAttribute("class"):e.className=i),e.__className=n}else if(a&&o!==a)for(var s in a){var u=!!a[s];(o==null||u!==!!o[s])&&e.classList.toggle(s,u)}return a}async function v(){return await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function A(e){const r=await window.crypto.subtle.exportKey("raw",e),n=new Uint8Array(r);let t="";const o=n.byteLength;for(let a=0;a<o;a++)t+=String.fromCharCode(n[a]);return btoa(t)}async function C(e){const r=atob(e),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return await window.crypto.subtle.importKey("raw",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function p(e,r){const n=window.crypto.getRandomValues(new Uint8Array(12)),t=new TextEncoder().encode(e),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,t),a=new Uint8Array(n.length+o.byteLength);a.set(n),a.set(new Uint8Array(o),n.length);let c="";const i=a.byteLength;for(let s=0;s<i;s++)c+=String.fromCharCode(a[s]);return btoa(c)}async function w(e,r){const n=atob(e),t=new Uint8Array(n.length);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);const o=t.slice(0,12),a=t.slice(12),c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},r,a);return new TextDecoder().decode(c)}async function l(){const e=localStorage.getItem("encryption_key");if(e)return C(e);{const r=await v(),n=await A(r);return localStorage.setItem("encryption_key",n),r}}const S=g({activeServer:null}),h=g({cardOrder:[],timestamp:Date.now()}),y="app_server_config_encrypted",b="dashboard_layout_encrypted";async function O(){try{const e=localStorage.getItem(y);if(e){const r=await l(),n=await w(e,r),t=JSON.parse(n);t&&t.url&&t.token&&S.update(o=>({...o,activeServer:t}))}}catch(e){console.error("Failed to load server config",e),localStorage.removeItem(y)}}async function I(e){try{const r=await l(),n=JSON.stringify(e),t=await p(n,r);localStorage.setItem(y,t),S.update(o=>({...o,activeServer:e}))}catch(r){throw console.error("Failed to save server config",r),r}}async function L(){try{const e=localStorage.getItem(b);if(e){const r=await l(),n=await w(e,r),t=JSON.parse(n);h.set(t)}}catch(e){console.error("Failed to load layout:",e)}}async function N(e){const r={cardOrder:e,timestamp:Date.now()};try{const n=await l(),t=JSON.stringify(r),o=await p(t,n);localStorage.setItem(b,o),h.set(r)}catch(n){console.error("Failed to save layout:",n)}}export{S as a,K as b,L as c,h as d,N as e,O as l,I as s};
