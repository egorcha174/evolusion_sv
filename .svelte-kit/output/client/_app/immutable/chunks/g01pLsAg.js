import{V as f,w as g}from"./ckSiSke7.js";const d=[...` 	
\r\fÂ \v\uFEFF`];function m(t,r,n){var e=t==null?"":""+t;if(r&&(e=e?e+" "+r:r),n){for(var o in n)if(n[o])e=e?e+" "+o:o;else if(e.length)for(var a=o.length,c=0;(c=e.indexOf(o,c))>=0;){var i=c+a;(c===0||d.includes(e[c-1]))&&(i===e.length||d.includes(e[i]))?e=(c===0?"":e.substring(0,c))+e.substring(i+1):c=i}}return e===""?null:e}function K(t,r){return t==null?null:String(t)}function O(t,r,n,e,o,a){var c=t.__className;if(f||c!==n||c===void 0){var i=m(n,e,a);(!f||i!==t.getAttribute("class"))&&(i==null?t.removeAttribute("class"):t.className=i),t.__className=n}else if(a&&o!==a)for(var s in a){var u=!!a[s];(o==null||u!==!!o[s])&&t.classList.toggle(s,u)}return a}async function v(){return await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function A(t){const r=await window.crypto.subtle.exportKey("raw",t),n=new Uint8Array(r);let e="";const o=n.byteLength;for(let a=0;a<o;a++)e+=String.fromCharCode(n[a]);return btoa(e)}async function C(t){const r=atob(t),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return await window.crypto.subtle.importKey("raw",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function w(t,r){const n=window.crypto.getRandomValues(new Uint8Array(12)),e=new TextEncoder().encode(t),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,e),a=new Uint8Array(n.length+o.byteLength);a.set(n),a.set(new Uint8Array(o),n.length);let c="";const i=a.byteLength;for(let s=0;s<i;s++)c+=String.fromCharCode(a[s]);return btoa(c)}async function p(t,r){const n=atob(t),e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=n.charCodeAt(i);const o=e.slice(0,12),a=e.slice(12),c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},r,a);return new TextDecoder().decode(c)}async function l(){const t=localStorage.getItem("encryption_key");if(t)return C(t);{const r=await v(),n=await A(r);return localStorage.setItem("encryption_key",n),r}}const S=g({activeServer:null}),b=g({cardOrder:[],timestamp:Date.now()}),y="app_server_config_encrypted",h="dashboard_layout_encrypted";async function I(){try{const t=localStorage.getItem(y);if(t){const r=await l(),n=await p(t,r),e=JSON.parse(n);e&&e.url&&e.token&&S.update(o=>({...o,activeServer:e}))}}catch(t){console.error("Failed to load server config",t),localStorage.removeItem(y)}}async function L(t){try{const r=await l(),n=JSON.stringify(t),e=await w(n,r);localStorage.setItem(y,e),S.update(o=>({...o,activeServer:t}))}catch(r){throw console.error("Failed to save server config",r),r}}async function N(){try{const t=localStorage.getItem(h);if(t){const r=await l(),n=await p(t,r),e=JSON.parse(n);b.set(e)}}catch(t){console.error("Failed to load layout:",t)}}async function U(t){const r={cardOrder:t,timestamp:Date.now()};try{const n=await l(),e=JSON.stringify(r),o=await w(e,n);localStorage.setItem(h,o),b.set(r)}catch(n){console.error("Failed to save layout:",n)}}export{S as a,O as b,U as c,I as d,N as e,b as l,L as s,K as t};
